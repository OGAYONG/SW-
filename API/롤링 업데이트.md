# 롤링 업데이트



* 이미 배포된 어플리케이션을 업데이트 하고 싶을때,

  기존의 방식은 서버를 닫고, 업데이트 후, 재 배포의 과정.

* 그러나 쿠버네티스는 롤링 업데이트를 통해 과정을 없애버림.

* deployment가 새로운 버전으로 업데이트 되면, 새로운 replicaset을 만들고,

  이전 replicaset을 줄이면서 새로운 replicaset의 수를 점차적으로 늘리는 방식을 사용

* 덕분에 버전의 업데이트를, 사용 중단없이 이용자에게 제공할 수 있게만듬.

* 디플로이먼트의 파드를 교체하는 전략은 .specs.strategy.type로 정의 되며 RollingUpdate(기본값), Recreate(기존 파드가 모두 삭제된 다음 새로운 파드를 생성함) 중 선택한다.

* 실행중인 컨테이너에 대한 헬스체크 설정
쿠버네티스의 컨테이너 헬스체크에는 livenessProbe, readinessProbe 기능이 있다.

전에 했던 probe:::
livenessProbe: 어플리케이션 헬스 체크 기능으로 어플리케이션이 의존하는 컨테이너 안의 파일이 존재하는지를 확인하는 용도로 사용된다.
readinessProbe : 컨테이너 외부에서 HTTP 요청같은 트래픽을 발생시켜 이를 처리할 수 있는 상태인지를 확인하는 기능이다.

헬스체크 기능을 포함한 컨테이너는 Running 상태가 되어도 READY 가 0/1 로 나오다가 모든 헬스 체크를 통과하고 1/1로 된다.

* 애플리케이션 스케일링과 유사하게, 디플로이먼트가 외부로 노출되면, 서비스는 업데이트가 이루어지는 동안 오직 가용한 파드에게만 트래픽을 로드밸런스 할 것이다. 가용한 파드란 애플리케이션의 사용자들에게 가용한 상태의 인스턴스를 말한다.

롤링 업데이트는 다음 동작들을 허용해준다:

하나의 환경에서 또 다른 환경으로의 애플리케이션 프로모션 (컨테이너 이미지 업데이트를 통해)
이전 버전으로의 롤백
서비스 중단 없는 애플리케이션의 지속적인 통합과 지속적인 전달
